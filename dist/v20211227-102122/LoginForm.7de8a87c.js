import{D as V,aR as x,aJ as m,r as u,R as K,j as S,u as e,F as P,G as A,H as b,J as k,v as s,a9 as a,aS as G,K as q,aT as H,aU as g,L as f,aH as U,ab as J,aV as O,aW as W,t as Q}from"./vendor.2e1d877b.js";/* empty css              *//* empty css               *//* empty css               */import{u as X,a as Y,L as j,_ as Z,b as ee}from"./LoginFormTitle.07676317.js";import{b as se,a as ae,f as te,u as oe,h as le}from"./index.86e9d70c.js";import{b as C}from"./uuid.4c14c5c2.js";import"http://at.alicdn.com/t/font_2948274_sdqssf53jp.js";const ne=["src","alt"],ye=V({setup(re){const i=O,y=W,r=x.Item,R=m.Password,{t:o}=se(),{notification:I,createErrorModal:F}=le(),{prefixCls:L}=ae("login"),D=te(),T=oe(),{setLoginState:$,getLoginState:z}=X(),{getFormRules:E}=Y(),v=u(),d=u(!1),h=u(!1),n=K({account:"",password:"",captcha:""}),p=u(C()),B=S(()=>`${T.apiUrl}/captcha.jpg?uuid=${p.value}`);function M(){p.value=C()}const{validForm:N}=ee(v),w=S(()=>e(z)===j.LOGIN);async function _(){const c=await N();if(!!c)try{d.value=!0;const t=await D.login(Q({password:c.password,username:c.account,captcha:c.captcha,uuid:e(p),mode:"none"}));t&&I.success({message:o("sys.login.loginSuccessTitle"),description:`${o("sys.login.loginSuccessDesc")}: ${t.username}`,duration:3})}catch(t){F({title:o("sys.api.errorTip"),content:t.message||o("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${L}`)||document.body})}finally{d.value=!1}}return(c,t)=>(P(),A(J,null,[b(s(Z,{class:"enter-x"},null,512),[[k,e(w)]]),b(s(e(x),{class:"p-4 enter-x",model:e(n),rules:e(E),ref_key:"formRef",ref:v},{default:a(()=>[s(e(r),{name:"account",class:"enter-x"},{default:a(()=>[s(e(m),{size:"large",value:e(n).account,"onUpdate:value":t[0]||(t[0]=l=>e(n).account=l),placeholder:e(o)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(r),{name:"password",class:"enter-x"},{default:a(()=>[s(e(R),{size:"large",visibilityToggle:"",value:e(n).password,"onUpdate:value":t[1]||(t[1]=l=>e(n).password=l),placeholder:e(o)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(r),{name:"captcha",class:"enter-x"},{default:a(()=>[s(e(y),null,{default:a(()=>[s(e(i),{span:14},{default:a(()=>[s(e(m),{class:"captcha",size:"large",visibilityToggle:"",value:e(n).captcha,"onUpdate:value":t[2]||(t[2]=l=>e(n).captcha=l),placeholder:e(o)("sys.login.captchaCode"),onKeypress:G(_,["enter"])},null,8,["value","placeholder","onKeypress"])]),_:1}),s(e(i),{span:9,offset:1},{default:a(()=>[q("img",{class:"captcha-img",src:e(B),alt:e(o)("sys.login.nocaptchaImgUrl"),onClick:M},null,8,ne)]),_:1})]),_:1})]),_:1}),s(e(y),{class:"enter-x"},{default:a(()=>[s(e(i),{span:12},{default:a(()=>[s(e(r),null,{default:a(()=>[s(e(H),{checked:h.value,"onUpdate:checked":t[3]||(t[3]=l=>h.value=l),size:"small"},{default:a(()=>[g(f(e(o)("sys.login.rememberMe")),1)]),_:1},8,["checked"])]),_:1})]),_:1}),s(e(i),{span:12},{default:a(()=>[s(e(r),{style:{"text-align":"right"}},{default:a(()=>[s(e(U),{type:"link",size:"small",onClick:t[4]||(t[4]=l=>e($)(e(j).RESET_PASSWORD))},{default:a(()=>[g(f(e(o)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(e(r),{class:"enter-x"},{default:a(()=>[s(e(U),{type:"primary",size:"large",block:"",onClick:_,loading:d.value},{default:a(()=>[g(f(e(o)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"]),[[k,e(w)]])],64))}});export{ye as default};
