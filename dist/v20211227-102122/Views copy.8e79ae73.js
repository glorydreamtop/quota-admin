import{D as K,j as W,r as G,V as B,m as J,cj as L,R as Y,a1 as Z,bW as N,aD as Q,ct as X,ba as ee,F as h,G as w,ab as te,ac as se,N as C,u as n,Z as D,ad as M,H as m,J as j,K as c,L as x,v as z,a9 as ie,a3 as ae,b8 as oe,O as ne,P as de,cu as O,cv as re,bv as F}from"./vendor.2e1d877b.js";import{u as le,e as ce,f as pe,g as fe}from"./hooks.ef8c9d99.js";import{B as ge}from"./BasicChart.cf132508.js";import ue from"./Text.9d9a1cef.js";import he from"./Image.d090c7e5.js";import{_ as me,I as xe}from"./index.86e9d70c.js";import{o as ve}from"./onMountedOrActivated.9356963a.js";import{u as _e}from"./commonHelper.b6c14153.js";import{f as be}from"./helper.3f416d3d.js";import{D as we}from"./vuedraggable.umd.c8c6d29c.js";import"./useECharts.5b02ea72.js";import"./useTimeout.534f4a33.js";import"./chartEnum.d23a2dc2.js";import"./index.b2a7a6f0.js";import"./quotaEnum.42e6645f.js";import"./YAxisEditor.ca3fb716.js";/* empty css                *//* empty css                *//* empty css                *//* empty css              */import"./index.8d549ca9.js";/* empty css               */import"./uuid.4c14c5c2.js";import"http://at.alicdn.com/t/font_2948274_sdqssf53jp.js";/* empty css                */import"./useContextMenu.029884b8.js";/* empty css                */import"./sortable.esm.c79628ac.js";const P=v=>(ne("data-v-6dc84d34"),v=v(),de(),v),je={class:"w-full overflow-y-scroll p-2",id:"page-box"},Ie=["data-pageid"],ye={class:"pb-1 border-b page-header"},Ce={class:"flex gap-1"},qe=P(()=>c("img",{class:"w-3.5 h-3.5",src:"http://121.4.186.36:23587/favicon.ico"},null,-1)),ke=["onClick","data-uniqid"],Ee={class:"pt-1 border-t page-footer"},Te={class:"flex gap-1"},Se=P(()=>c("img",{class:"w-3.5 h-3.5",src:"http://121.4.186.36:23587/favicon.ico"},null,-1)),Be=K({setup(v){const o=le(),q=ce(),H=W(()=>({paddingTop:`${o.paddingTop}px`,paddingBottom:`${o.paddingBottom}px`,paddingLeft:`${o.paddingLeft}px`,paddingRight:`${o.paddingRight}px`,aspectRatio:o.pagination?o.horizontal?"297/210":"210/297":"unset"})),I=G(!1);B(()=>o.pagination,()=>{const s=J(g.value);I.value=!0,g.value=[],a.pages=[{list:[],id:_()}],I.value=!1;for(let e=0;e<s.length;e++)L(()=>{g.value.push(s[e])},30*e)});const g=pe(),R={Chart:ge,Text:ue,Img:he},{insertSelectKey:U,clearSelectKey:y}=fe(g,q);function V(s,e){U(s,e)}const a=Y({pages:[],totalPage:1}),{getUniqueField:_}=be();_e(g,(s,e)=>{if(!I.value){if(e.length<s.length){const d=O(s,e,i=>i.uniqId);for(let i=0;i<d.length;i++){const p=re(s,t=>t.uniqId===d[i].uniqId);if(p===0)a.pages[0].list.unshift(d[i]);else{const t=s[p-1];for(let r=0;r<a.pages.length;r++){const b=a.pages[r],f=b.list.findIndex(u=>u.uniqId===t.uniqId);if(f>-1){b.list.splice(f+1,0,d[i]);break}}}}}else if(e.length>s.length){const d=O(e,s,i=>i.uniqId).map(i=>i.uniqId);for(let i=0;i<a.pages.length;i++){const p=a.pages[i];F(p.list,t=>d.includes(t.uniqId))}F(a.pages,i=>i.list.length===0),a.pages.length===0&&(a.pages=[{list:[],id:_()}])}}});function $(s){for(let e=0;e<s.childElementCount;e++){const d=s.children[e];if(d.offsetTop+d.offsetHeight>s.offsetTop+s.offsetHeight||d.offsetLeft+d.offsetWidth>s.offsetLeft+s.offsetWidth)return e}return!1}B(()=>a.totalPage,async()=>{await Z()});function k(s,e){o.header[s]=e.target.innerText}function E(s,e){o.footer[s]=e.target.innerText}return ve(()=>{const s=document.getElementById("page-box");N(s,e=>{e.forEach(d=>{d.addedNodes.length!==0&&d.addedNodes.forEach(i=>{N(i.children[1],p=>{p.forEach(t=>{t.addedNodes.length!==0&&t.addedNodes.forEach(r=>{Q(r,b=>{const f=b[0].target;if(X(f.parentElement))return;const u=g.value.find(T=>T.uniqId===f.dataset.uniqid);if(u){if(u.pageConfig.width=f.style.width,u.pageConfig.height=f.style.height,!o.pagination)return;if($(f.parentElement)){const S=i.nextElementSibling;if(S){for(let l=0;l<a.pages.length;l++)if(a.pages[l].id===S.dataset.pageid){a.pages[l].list.unshift(a.pages[l-1].list.pop());break}}else a.pages.push({list:[],id:_()}),a.totalPage++,L(()=>{for(let l=0;l<a.pages.length;l++)if(a.pages[l].id===i.nextElementSibling.dataset.pageid){a.pages[l].list.unshift(a.pages[l-1].list.pop());break}},100)}}})})})},{childList:!0})})})},{childList:!0}),a.pages.push({list:[],id:_()})}),(s,e)=>{const d=ee("resizeable");return h(),w("div",je,[(h(!0),w(te,null,se(n(a).pages,(i,p)=>(h(),w("div",{class:C(["pages bg-white overflow-hidden shadow-lg shadow-gray-700 flex flex-col items-center gap-4",n(o).pagination?"mb-8":""]),key:i.id,"data-pageid":i.id,style:D(n(H)),onClick:e[4]||(e[4]=M((...t)=>n(y)&&n(y)(...t),["self"]))},[m(c("div",ye,[c("span",{contenteditable:"",onInput:e[0]||(e[0]=t=>k("left",t))},x(n(o).header.left),33),c("span",Ce,[qe,c("span",{contenteditable:"",onInput:e[1]||(e[1]=t=>k("right",t)),class:"text-right"},x(n(o).header.right),33)])],512),[[j,n(o).header.show]]),z(n(we),{class:"flex flex-wrap content-start flex-grow w-full overflow-hidden",onClick:M(n(y),["self"]),list:i.list,group:"page",handle:".drag-handler",animation:200,itemKey:"uniqId"},{item:ie(({element:t})=>[m((h(),w("div",{onClick:r=>V(t,r),"data-uniqid":t.uniqId,class:C(["border rounded-sm overflow-hidden sortable relative",n(q).find(r=>r.uniqId===t.uniqId)?"selected":"",n(o).showElementborder?"":"border-light-50"]),style:D({width:t.pageConfig.width,height:t.pageConfig.height})},[z(n(xe),{icon:"akar-icons:drag-horizontal",class:"drag-handler cursor-move pl-1 pt-1 !text-primary"}),(h(),ae(oe(R[t.type]),{config:t.config,"onUpdate:config":r=>t.config=r,class:C(["w-full h-full text-base",t.type==="Chart"?"py-2":""])},null,8,["config","onUpdate:config","class"]))],14,ke)),[[d,"xy","hidden"]])]),_:2},1032,["onClick","list"]),c("div",Ee,[m(c("span",{contenteditable:"",onInput:e[2]||(e[2]=t=>E("left",t))},x(n(o).footer.left),545),[[j,n(o).footer.show]]),m(c("span",{class:"footer-page-num"},x(p+1),513),[[j,n(o).footer.pageNum]]),m(c("span",Te,[Se,c("span",{contenteditable:"",onInput:e[3]||(e[3]=t=>E("right",t))},x(n(o).footer.right),33)],512),[[j,n(o).footer.show]])])],14,Ie))),128))])}}});var nt=me(Be,[["__scopeId","data-v-6dc84d34"]]);export{nt as default};
