var ge=Object.defineProperty,me=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var x=(e,o,a)=>o in e?ge(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,M=(e,o)=>{for(var a in o||(o={}))be.call(o,a)&&x(e,a,o[a]);if(Q)for(var a of Q(o))ye.call(o,a)&&x(e,a,o[a]);return e},V=(e,o)=>me(e,he(o));import{b as ee,ah as ve,ap as Ce,s as Me,t as He,_,a as te,q as ne,aC as Se,ai as Fe,az as oe,ab as ke}from"./index.86e9d70c.js";import{aq as I,u as s,D as w,Y as $e,v as H,bs as Be,aj as R,q as Oe,r as g,bW as Pe,j as S,V as le,a0 as Te,be as ae,a1 as B,a2 as b,ba as we,F as v,a3 as O,a9 as m,H as Re,G as A,am as P,Z as De,ah as Ne,b4 as We,b5 as je,bJ as _e,ab as Ee,ae as z,N as Le,aU as Y,L as U,b1 as Ve,o as X,aF as G,al as se,ac as re,ak as ie,aI as ce,R as ue,t as q,bL as Ie,bn as Ae}from"./vendor.2e1d877b.js";import{u as qe}from"./useTimeout.534f4a33.js";import{u as ze}from"./useWindowSizeFn.752f6aa7.js";import{S as Ye,b as Ue}from"./index.0fb85ddd.js";const{t:de}=ee(),Xe={visible:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:de("common.cancelText")},okText:{type:String,default:de("common.okText")},closeFunc:Function},J=Object.assign({},Xe,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function Ge(e){const o=(l,c)=>getComputedStyle(l)[c],a=l=>{if(!l)return;l.setAttribute("data-drag",s(e.draggable));const c=l.querySelector(".ant-modal-header"),t=l.querySelector(".ant-modal");!c||!t||!s(e.draggable)||(c.style.cursor="move",c.onmousedown=n=>{if(!n)return;const p=n.clientX,u=n.clientY,d=document.body.clientWidth,f=document.documentElement.clientHeight,h=t.offsetWidth,C=t.offsetHeight,F=t.offsetLeft,k=d-t.offsetLeft-h,$=t.offsetTop,E=f-t.offsetTop-C,T=o(t,"left"),N=o(t,"top");let W=+T,j=+N;T.includes("%")?(W=+document.body.clientWidth*(+T.replace(/%/g,"")/100),j=+document.body.clientHeight*(+N.replace(/%/g,"")/100)):(W=+T.replace(/px/g,""),j=+N.replace(/px/g,"")),document.onmousemove=function(L){let r=L.clientX-p,y=L.clientY-u;-r>F?r=-F:r>k&&(r=k),-y>$?y=-$:y>E&&(y=E),t.style.cssText+=`;left:${r+W}px;top:${y+j}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},i=()=>{const l=document.querySelectorAll(".ant-modal-wrap");for(const c of Array.from(l)){if(!c)continue;const t=o(c,"display"),n=c.getAttribute("data-drag");t!=="none"&&(n===null||s(e.destroyOnClose))&&a(c)}};I(()=>{!s(e.visible)||!s(e.draggable)||qe(()=>{i()},30)})}function Je(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Be(e)}var Ze=w({name:"Modal",inheritAttrs:!1,props:J,emits:["cancel"],setup(e,{slots:o,emit:a}){const{visible:i,draggable:l,destroyOnClose:c}=$e(e),t=ve();Ge({visible:i,destroyOnClose:c,draggable:l});const n=p=>{a("cancel",p)};return()=>{let p;const u=M(M({},s(t)),e);return H(Oe,R(u,{onCancel:n}),Je(p=Ce(o))?p:{default:()=>[p]})}}});const fe=Symbol();function Ke(e){return Me(e,fe)}function Ht(){return He(fe)}const Qe={loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},visible:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},xe=w({name:"ModalWrapper",components:{ScrollContainer:Ye},inheritAttrs:!1,props:Qe,emits:["height-change","ext-height"],setup(e,{emit:o}){const a=g(null),i=g(null),l=g(0),c=g(0);let t=0;ze(u.bind(null,!1)),Pe(i,()=>{u()},{attributes:!0,subtree:!0}),Ke({redoModalHeight:u});const n=S(()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${s(l)}px`}));I(()=>{e.useWrapper&&u()}),le(()=>e.fullScreen,d=>{u(),d?c.value=l.value:l.value=c.value}),Te(()=>{const{modalHeaderHeight:d,modalFooterHeight:f}=e;o("ext-height",d+f)}),ae(()=>{});async function p(){B(()=>{var f;const d=s(a);!d||(f=d==null?void 0:d.scrollTo)==null||f.call(d,0)})}async function u(){if(!e.visible)return;const d=s(a);if(!d)return;const f=d.$el.parentElement;if(!!f){f.style.padding="0",await B();try{const h=f.parentElement&&f.parentElement.parentElement;if(!h)return;const C=getComputedStyle(h).top,F=Number.parseInt(C);let k=window.innerHeight-F*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;F<40&&(k-=26),await B();const $=s(i);if(!$)return;await B(),t=$.scrollHeight,e.fullScreen?l.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:l.value=e.height?e.height:t>k?k:t,o("height-change",s(l))}catch(h){console.log(h)}}}return{wrapperRef:a,spinRef:i,spinStyle:n,scrollTop:p,setModalHeight:u}}}),et=["loading-tip"];function tt(e,o,a,i,l,c){const t=b("ScrollContainer"),n=we("loading");return v(),O(t,{ref:"wrapperRef"},{default:m(()=>[Re((v(),A("div",{ref:"spinRef",style:De(e.spinStyle),"loading-tip":e.loadingTip},[P(e.$slots,"default")],12,et)),[[n,e.loading]])]),_:3},512)}var nt=_(xe,[["render",tt]]);const ot=w({name:"ModalClose",components:{Tooltip:Ne,FullscreenExitOutlined:We,FullscreenOutlined:je,CloseOutlined:_e},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(e,{emit:o}){const{prefixCls:a}=te("basic-modal-close"),{t:i}=ee(),l=S(()=>[a,`${a}--custom`,{[`${a}--can-full`]:e.canFullscreen}]);function c(n){o("cancel",n)}function t(n){n==null||n.stopPropagation(),n==null||n.preventDefault(),o("fullscreen")}return{t:i,getClass:l,prefixCls:a,handleCancel:c,handleFullScreen:t}}});function lt(e,o,a,i,l,c){const t=b("FullscreenExitOutlined"),n=b("Tooltip"),p=b("FullscreenOutlined"),u=b("CloseOutlined");return v(),A("div",{class:Le(e.getClass)},[e.canFullscreen?(v(),A(Ee,{key:0},[e.fullScreen?(v(),O(n,{key:0,title:e.t("component.modal.restore"),placement:"bottom"},{default:m(()=>[H(t,{role:"full",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"])):(v(),O(n,{key:1,title:e.t("component.modal.maximize"),placement:"bottom"},{default:m(()=>[H(p,{role:"close",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"]))],64)):z("",!0),H(n,{title:e.t("component.modal.close"),placement:"bottom"},{default:m(()=>[H(u,{onClick:e.handleCancel},null,8,["onClick"])]),_:1},8,["title"])],2)}var at=_(ot,[["render",lt]]);const st=w({name:"BasicModalFooter",props:J,emits:["ok","cancel"],setup(e,{emit:o}){function a(l){o("ok",l)}function i(l){o("cancel",l)}return{handleOk:a,handleCancel:i}}});function rt(e,o,a,i,l,c){const t=b("a-button");return v(),A("div",null,[P(e.$slots,"insertFooter"),e.showCancelBtn?(v(),O(t,R({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:m(()=>[Y(U(e.cancelText),1)]),_:1},16,["onClick"])):z("",!0),P(e.$slots,"centerFooter"),e.showOkBtn?(v(),O(t,R({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:m(()=>[Y(U(e.okText),1)]),_:1},16,["type","onClick","loading"])):z("",!0),P(e.$slots,"appendFooter")])}var it=_(st,[["render",rt]]);const ct=w({name:"BasicModalHeader",components:{BasicTitle:Ue},props:{helpMessage:{type:[String,Array]},title:{type:String}},emits:["dblclick"]});function ut(e,o,a,i,l,c){const t=b("BasicTitle");return v(),O(t,{helpMessage:e.helpMessage},{default:m(()=>[Y(U(e.title),1)]),_:1},8,["helpMessage"])}var dt=_(ct,[["render",ut]]);function ft(e){const o=g(!1),a=S(()=>{const l=s(e.wrapClassName)||"";return s(o)?`fullscreen-modal ${l} `:s(l)});function i(l){l&&l.stopPropagation(),o.value=!s(o)}return{getWrapClassName:a,handleFullScreen:i,fullScreenRef:o}}const pt=w({name:"BasicModal",components:{Modal:Ze,ModalWrapper:nt,ModalClose:at,ModalFooter:it,ModalHeader:dt},inheritAttrs:!1,props:J,emits:["visible-change","height-change","cancel","ok","register","update:visible"],setup(e,{emit:o,attrs:a}){const i=g(!1),l=g(null),c=g(null),{prefixCls:t}=te("basic-modal"),n=g(0),p={setModalProps:T,emitVisible:void 0,redoModalHeight:()=>{B(()=>{s(c)&&s(c).setModalHeight()})}},u=G();u&&o("register",p,u.uid);const d=S(()=>M(M({},e),s(l))),{handleFullScreen:f,getWrapClassName:h,fullScreenRef:C}=ft({modalWrapperRef:c,extHeightRef:n,wrapClassName:Ve(d.value,"wrapClassName")}),F=S(()=>{const r=V(M({},s(d)),{visible:s(i),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return V(M({},r),{wrapClassName:s(h)})}),k=S(()=>{const r=V(M(M({},a),s(d)),{visible:s(i),wrapClassName:s(h)});return s(C)?X(r,["height","title"]):(console.log(r),X(r,"title"))}),$=S(()=>{if(!s(C))return s(F).height});I(()=>{i.value=!!e.visible,C.value=!!e.defaultFullscreen}),le(()=>s(i),r=>{var y;o("visible-change",r),o("update:visible",r),u&&((y=p.emitVisible)==null||y.call(p,r,u.uid)),B(()=>{e.scrollTop&&r&&s(c)&&s(c).scrollTop()})},{immediate:!1});async function E(r){var y,K;if(console.log(r),r==null||r.stopPropagation(),!((K=(y=r.target)==null?void 0:y.classList)==null?void 0:K.contains(t+"-close--custom"))){if(e.closeFunc&&ne(e.closeFunc)){const pe=await e.closeFunc();i.value=!pe;return}i.value=!1,o("cancel",r)}}function T(r){l.value=Se(s(l)||{},r),Reflect.has(r,"visible")&&(i.value=!!r.visible),Reflect.has(r,"defaultFullscreen")&&(C.value=!!r.defaultFullscreen)}function N(r){o("ok",r)}function W(r){o("height-change",r)}function j(r){n.value=r}function L(r){!e.canFullscreen||(r.stopPropagation(),f(r))}return{handleCancel:E,getBindValue:k,getProps:F,handleFullScreen:f,fullScreenRef:C,getMergeProps:d,handleOk:N,visibleRef:i,omit:X,modalWrapperRef:c,handleExtHeight:j,handleHeightChange:W,handleTitleDbClick:L,getWrapperHeight:$}}});function gt(e,o,a,i,l,c){const t=b("ModalClose"),n=b("ModalHeader"),p=b("ModalFooter"),u=b("ModalWrapper"),d=b("Modal");return v(),O(d,R(e.getBindValue,{onCancel:e.handleCancel}),se({default:m(()=>[H(u,R({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:e.footer!==void 0&&!e.footer?0:void 0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:m(()=>[P(e.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])]),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:m(()=>[H(t,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])])},e.$slots.title?void 0:{name:"title",fn:m(()=>[H(n,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])])},e.$slots.footer?void 0:{name:"footer",fn:m(()=>[H(p,R(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),se({_:2},[re(Object.keys(e.$slots),f=>({name:f,fn:m(h=>[P(e.$slots,f,ie(ce(h||{})))])}))]),1040,["onOk","onCancel"])])},re(Object.keys(e.omit(e.$slots,"default")),f=>({name:f,fn:m(h=>[P(e.$slots,f,ie(ce(h||{})))])}))]),1040,["onCancel"])}var mt=_(pt,[["render",gt]]);const D=ue({}),Z=ue({});function St(){const e=g(null),o=g(!1),a=g("");function i(t,n){if(!G())throw new Error("useModal() can only be used inside setup() or functional components!");a.value=n,ae(()=>{e.value=null,o.value=!1,D[s(a)]=null}),!(s(o)&&Fe()&&t===s(e))&&(e.value=t,o.value=!0,t.emitVisible=(p,u)=>{Z[u]=p})}const l=()=>{const t=s(e);return t||oe("useModal instance is undefined!"),t},c={setModalProps:t=>{var n;(n=l())==null||n.setModalProps(t)},getVisible:S(()=>Z[~~s(a)]),redoModalHeight:()=>{var t,n;(n=(t=l())==null?void 0:t.redoModalHeight)==null||n.call(t)},openModal:(t=!0,n,p=!0)=>{var f;if((f=l())==null||f.setModalProps({visible:t}),!n)return;const u=s(a);if(p){D[u]=null,D[u]=q(n);return}Ie(q(D[u]),q(n))||(D[u]=q(n))},closeModal:()=>{var t;(t=l())==null||t.setModalProps({visible:!1})}};return[i,c]}const Ft=e=>{const o=g(null),a=G(),i=g(""),l=()=>{const t=s(o);return t||oe("useModalInner instance is undefined!"),t},c=(t,n)=>{Ae(()=>{o.value=null}),i.value=n,o.value=t,a==null||a.emit("register",t,n)};return I(()=>{const t=D[s(i)];!t||!e||!ne(e)||B(()=>{e(t)})}),[c,{changeLoading:(t=!0)=>{var n;(n=l())==null||n.setModalProps({loading:t})},getVisible:S(()=>Z[~~s(i)]),changeOkLoading:(t=!0)=>{var n;(n=l())==null||n.setModalProps({confirmLoading:t})},closeModal:()=>{var t;(t=l())==null||t.setModalProps({visible:!1})},setModalProps:t=>{var n;(n=l())==null||n.setModalProps(t)},redoModalHeight:()=>{var n;const t=(n=l())==null?void 0:n.redoModalHeight;t&&t()}}]},kt=ke(mt);export{kt as B,St as a,Ft as b,Ht as u};
