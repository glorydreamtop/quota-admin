import{D as J,j as Y,r as Z,V as M,m as Q,cj as B,R as X,a1 as ee,bW as N,aD as te,ct as se,ba as ae,F as h,G as _,ab as ie,ac as oe,N as y,u as n,Z as D,ad as H,H as m,J as I,K as c,L as x,v as z,a9 as ne,a3 as re,b8 as de,O as le,P as ce,cu as O,cv as pe,bv as V}from"./vendor.2e1d877b.js";import{u as fe,e as ge,f as ue,g as he}from"./hooks.ef8c9d99.js";import{B as me}from"./BasicChart.cf132508.js";import xe from"./Text.9d9a1cef.js";import ve from"./Image.d090c7e5.js";import{_ as be,b as we,I as _e}from"./index.86e9d70c.js";import{o as Ie}from"./onMountedOrActivated.9356963a.js";import{u as je}from"./commonHelper.b6c14153.js";import{f as Ce}from"./helper.3f416d3d.js";import{D as ye}from"./vuedraggable.umd.c8c6d29c.js";import{u as qe}from"./useContextMenu.029884b8.js";import"./useECharts.5b02ea72.js";import"./useTimeout.534f4a33.js";import"./chartEnum.d23a2dc2.js";import"./index.b2a7a6f0.js";import"./quotaEnum.42e6645f.js";import"./YAxisEditor.ca3fb716.js";/* empty css                *//* empty css                *//* empty css                *//* empty css              */import"./index.8d549ca9.js";/* empty css               */import"./uuid.4c14c5c2.js";/* empty css                */import"http://at.alicdn.com/t/font_2948274_sdqssf53jp.js";import"./sortable.esm.c79628ac.js";/* empty css                */const F=v=>(le("data-v-2252bafc"),v=v(),ce(),v),ke={class:"w-full overflow-y-scroll p-2",id:"page-box"},Ee=["data-pageid"],Te={class:"pb-1 border-b page-header"},Se={class:"flex gap-1"},Le=F(()=>c("img",{class:"w-3.5 h-3.5",src:"http://121.4.186.36:23587/favicon.ico"},null,-1)),Me=["onClick","data-uniqid"],Be={class:"pt-1 border-t page-footer"},Ne={class:"flex gap-1"},De=F(()=>c("img",{class:"w-3.5 h-3.5",src:"http://121.4.186.36:23587/favicon.ico"},null,-1)),He=J({setup(v){const{t:q}=we(),[P]=qe(),o=fe(),k=ge(),R=Y(()=>({paddingTop:`${o.paddingTop}px`,paddingBottom:`${o.paddingBottom}px`,paddingLeft:`${o.paddingLeft}px`,paddingRight:`${o.paddingRight}px`,aspectRatio:o.pagination?o.horizontal?"297/210":"210/297":"unset"})),j=Z(!1);M(()=>o.pagination,()=>{const t=Q(g.value);j.value=!0,g.value=[],i.pages=[{list:[],id:b()}],j.value=!1;for(let e=0;e<t.length;e++)B(()=>{g.value.push(t[e])},30*e)});const g=ue(),U={Chart:me,Text:xe,Img:ve},{insertSelectKey:W,clearSelectKey:C}=he(g,k);function $(t,e){W(t,e)}const i=X({pages:[],totalPage:1}),{getUniqueField:b}=Ce();je(g,(t,e)=>{if(!j.value){if(e.length<t.length){const r=O(t,e,a=>a.uniqId);for(let a=0;a<r.length;a++){const p=pe(t,s=>s.uniqId===r[a].uniqId);if(p===0)i.pages[0].list.unshift(r[a]);else{const s=t[p-1];for(let d=0;d<i.pages.length;d++){const w=i.pages[d],f=w.list.findIndex(u=>u.uniqId===s.uniqId);if(f>-1){w.list.splice(f+1,0,r[a]);break}}}}}else if(e.length>t.length){const r=O(e,t,a=>a.uniqId).map(a=>a.uniqId);for(let a=0;a<i.pages.length;a++){const p=i.pages[a];V(p.list,s=>r.includes(s.uniqId))}V(i.pages,a=>a.list.length===0),i.pages.length===0&&(i.pages=[{list:[],id:b()}])}}});function A(t){for(let e=0;e<t.childElementCount;e++){const r=t.children[e];if(r.offsetTop+r.offsetHeight>t.offsetTop+t.offsetHeight||r.offsetLeft+r.offsetWidth>t.offsetLeft+t.offsetWidth)return e}return!1}M(()=>i.totalPage,async()=>{await ee()});function E(t,e){o.header[t]=e.target.innerText}function T(t,e){o.footer[t]=e.target.innerText}function K(t){P({event:t,items:[{label:q("templateView.view.dragHandleMenu.wholeLine")},{label:q("templateView.view.dragHandleMenu.notWholeLine")}]})}return Ie(()=>{const t=document.getElementById("page-box");N(t,e=>{e.forEach(r=>{r.addedNodes.length!==0&&r.addedNodes.forEach(a=>{N(a.children[1],p=>{p.forEach(s=>{s.addedNodes.length!==0&&s.addedNodes.forEach(d=>{te(d,w=>{const f=w[0].target;if(se(f.parentElement))return;const u=g.value.find(S=>S.uniqId===f.dataset.uniqid);if(u){if(u.pageConfig.width=f.style.width,u.pageConfig.height=f.style.height,!o.pagination)return;if(A(f.parentElement)){const L=a.nextElementSibling;if(L){for(let l=0;l<i.pages.length;l++)if(i.pages[l].id===L.dataset.pageid){i.pages[l].list.unshift(i.pages[l-1].list.pop());break}}else i.pages.push({list:[],id:b()}),i.totalPage++,B(()=>{for(let l=0;l<i.pages.length;l++)if(i.pages[l].id===a.nextElementSibling.dataset.pageid){i.pages[l].list.unshift(i.pages[l-1].list.pop());break}},96)}}})})})},{childList:!0})})})},{childList:!0}),i.pages.push({list:[],id:b()})}),(t,e)=>{const r=ae("resizeable");return h(),_("div",ke,[(h(!0),_(ie,null,oe(n(i).pages,(a,p)=>(h(),_("div",{class:y(["pages bg-white overflow-hidden shadow-lg shadow-gray-700 flex flex-col items-center gap-4",n(o).pagination?"mb-8":""]),key:a.id,"data-pageid":a.id,style:D(n(R)),onClick:e[4]||(e[4]=H((...s)=>n(C)&&n(C)(...s),["self"]))},[m(c("div",Te,[c("span",{contenteditable:"",onInput:e[0]||(e[0]=s=>E("left",s))},x(n(o).header.left),33),c("span",Se,[Le,c("span",{contenteditable:"",onInput:e[1]||(e[1]=s=>E("right",s)),class:"text-right"},x(n(o).header.right),33)])],512),[[I,n(o).header.show]]),z(n(ye),{class:"flex flex-wrap content-start flex-grow w-full overflow-hidden",onClick:H(n(C),["self"]),list:a.list,group:"page",handle:".drag-handler",animation:200,itemKey:"uniqId"},{item:ne(({element:s})=>[m((h(),_("div",{onClick:d=>$(s,d),"data-uniqid":s.uniqId,class:y(["border rounded-sm overflow-hidden sortable relative",n(k).find(d=>d.uniqId===s.uniqId)?"selected":"",n(o).showElementborder?"":"border-light-50"]),style:D(s.pageConfig)},[z(n(_e),{icon:"akar-icons:drag-horizontal",class:"drag-handler cursor-move pl-1 pt-1 !text-primary",onContextmenu:K}),(h(),re(de(U[s.type]),{config:s.config,"onUpdate:config":d=>s.config=d,class:y(["w-full h-full text-base",s.type==="Chart"?"py-2":""])},null,8,["config","onUpdate:config","class"]))],14,Me)),[[r,"xy","hidden"]])]),_:2},1032,["onClick","list"]),c("div",Be,[m(c("span",{contenteditable:"",onInput:e[2]||(e[2]=s=>T("left",s))},x(n(o).footer.left),545),[[I,n(o).footer.show]]),m(c("span",{class:"footer-page-num"},x(p+1),513),[[I,n(o).footer.pageNum]]),m(c("span",Ne,[De,c("span",{contenteditable:"",onInput:e[3]||(e[3]=s=>T("right",s))},x(n(o).footer.right),33)],512),[[I,n(o).footer.show]])])],14,Ee))),128))])}}});var pt=be(He,[["__scopeId","data-v-2252bafc"]]);export{pt as default};
