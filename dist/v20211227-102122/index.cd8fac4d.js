var Lt=Object.defineProperty,Ht=Object.defineProperties;var Kt=Object.getOwnPropertyDescriptors;var Ze=Object.getOwnPropertySymbols;var jt=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable;var et=(e,n,o)=>n in e?Lt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,I=(e,n)=>{for(var o in n||(n={}))jt.call(n,o)&&et(e,o,n[o]);if(Ze)for(var o of Ze(n))Mt.call(n,o)&&et(e,o,n[o]);return e},ie=(e,n)=>Ht(e,Kt(n));import{v as P,D as le,bB as tt,a2 as D,F as A,G as J,am as $e,aU as se,L as B,j as F,a3 as N,a9 as E,N as ne,ae as U,ab as Me,r as H,V as ge,u as t,bC as Bt,bD as Nt,aJ as Vt,bE as zt,bF as Wt,bG as Ut,aT as Ue,bH as Gt,bI as qt,B as Pe,b0 as nt,bJ as Yt,bK as Xt,a_ as Jt,o as Ee,aq as we,a1 as Ce,t as oe,d as Qt,s as Zt,ba as en,H as Be,J as Ge,K as re,aj as qe,m as Fe,bL as tn,R as ot,bt as at,a0 as nn,W as on,bM as an,ah as Ne,bN as ln,bA as lt,Y as sn,ac as Oe,bO as rn,an as cn,ai as st,bc as un,b4 as dn,b5 as fn,b6 as gn,bP as it,Q as mn,al as rt,ak as ct,aI as ut,bQ as dt,bR as hn,be as pn}from"./vendor.1ce5b3a9.js";import bn from"./DetailModal.c47d3411.js";/* empty css              *//* empty css                *//* empty css              *//* empty css               *//* empty css                */import{A as Cn,a as yn,B as Sn,u as vn}from"./useForm.0685912e.js";import{a as wn}from"./index.9b1a2903.js";import{B as Tn,_ as _n,S as Rn,b as kn}from"./index.f2f6fea5.js";import{_ as ce,a as Te,b as me,w as Q,X as In,p as j,ag as Ye,q as z,aa as xe,a9 as Ae,as as $n,at as Fn,al as Dn,au as Pn,av as En,af as On,I as xn,a8 as ft,a2 as gt,a5 as Xe,aw as An,ax as Ln,ai as Hn,ay as mt,az as Kn,aA as jn}from"./index.b82b58bf.js";import{P as Ve,a as Mn,u as _e,I as Le,A as ze,D as Bn,R as ue,F as ht,b as Nn,c as Vn,d as zn,e as Wn,T as Un}from"./index.497fafeb.js";/* empty css                *//* empty css                *//* empty css               *//* empty css               */import{u as Gn}from"./useTimeout.9c582638.js";import{b as pt}from"./uuid.4c14c5c2.js";import{u as qn}from"./useWindowSizeFn.31db8a65.js";import{u as Yn,a as Xn}from"./index.fa044461.js";import{o as Jn}from"./onMountedOrActivated.3ab72fe6.js";/* empty css                */import{u as Qn}from"./useSortable.8646d18e.js";/* empty css                *//* empty css                */import{getColumns as Zn}from"./data.31d50f90.js";import"./index.75b7dd47.js";/* empty css               *//* empty css               *//* empty css               */import"./index.6b5e08fe.js";import"./index.a19561bc.js";/* empty css               *//* empty css               */import"./useContentViewHeight.0badcf2d.js";import"http://at.alicdn.com/t/font_2948274_sdqssf53jp.js";/* empty css               */import"./download.33b6eaa1.js";import"./sortable.esm.c79628ac.js";var eo=()=>e=>e.expandable?P(Tn,{style:"margin-right: 8px",iconStyle:"margin-top: -2px;",onClick:n=>{e.onExpand(e.record,n)},expand:e.expanded},null):e.needIndentSpaced?P("span",{class:"ant-table-row-expand-icon ant-table-row-spaced"},null):P("span",null,null);const to=le({name:"EditTableHeaderIcon",components:{FormOutlined:tt},props:{title:{type:String,default:""}}});function no(e,n,o,r,s,u){const i=D("FormOutlined");return A(),J("span",null,[$e(e.$slots,"default"),se(" "+B(e.title)+" ",1),P(i)])}var oo=ce(to,[["render",no]]);const ao=le({name:"TableHeaderCell",components:{EditTableHeaderCell:oo,BasicHelp:_n},props:{column:{type:Object,default:()=>({})}},setup(e){const{prefixCls:n}=Te("basic-table-header-cell"),o=F(()=>{var u;return!!((u=e.column)==null?void 0:u.edit)}),r=F(()=>{var u;return(u=e.column)==null?void 0:u.customTitle}),s=F(()=>{var u;return(u=e.column)==null?void 0:u.helpMessage});return{prefixCls:n,getIsEdit:o,getTitle:r,getHelpMessage:s}}}),lo={key:1};function so(e,n,o,r,s,u){const i=D("EditTableHeaderCell"),d=D("BasicHelp");return A(),J(Me,null,[e.getIsEdit?(A(),N(i,{key:0},{default:E(()=>[se(B(e.getTitle),1)]),_:1})):(A(),J("span",lo,B(e.getTitle),1)),e.getHelpMessage?(A(),N(d,{key:2,text:e.getHelpMessage,class:ne(`${e.prefixCls}__help`)},null,8,["text","class"])):U("",!0)],64)}var io=ce(ao,[["render",so]]);function ro({page:e,type:n,originalElement:o}){return n==="prev"?e===0?null:P(Bt,null,null):n==="next"?e===1?null:P(Nt,null,null):o}function co(e){const{t:n}=me(),o=H({}),r=H(!0);ge(()=>t(e).pagination,a=>{!Q(a)&&a&&(o.value=I(I({},t(o)),a!=null?a:{}))});const s=F(()=>{const{pagination:a}=t(e);return!t(r)||Q(a)&&!a?!1:I(I({current:1,pageSize:Ve,size:"small",defaultPageSize:Ve,showTotal:y=>n("component.table.total",{total:y}),showSizeChanger:!0,pageSizeOptions:Mn,itemRender:ro,showQuickJumper:!0},Q(a)?{}:a),t(o))});function u(a){const y=t(s);o.value=I(I({},Q(y)?{}:y),a)}function i(){return t(s)}function d(){return t(r)}async function l(a){r.value=a}return{getPagination:i,getPaginationInfo:s,setShowPagination:l,getShowPagination:d,setPagination:u}}const de=new Map;de.set("Input",Vt);de.set("InputNumber",zt);de.set("Select",Wt);de.set("ApiSelect",Cn);de.set("ApiTreeSelect",yn);de.set("Switch",Ut);de.set("Checkbox",Ue);de.set("DatePicker",Gt);de.set("TimePicker",qt);const uo=({component:e="Input",rule:n=!0,ruleMessage:o,popoverVisible:r,getPopupContainer:s},{attrs:u})=>{const i=de.get(e),d=Pe(i,u);return n?Pe(nt,I({overlayClassName:"edit-cell-rule-popover",visible:!!r},s?{getPopupContainer:s}:{}),{default:()=>d,content:()=>o}):d},{t:Je}=me();function bt(e){return e.includes("Input")?Je("common.inputText"):e.includes("Picker")||e.includes("Select")||e.includes("Checkbox")||e.includes("Radio")||e.includes("Switch")||e.includes("DatePicker")||e.includes("TimePicker")?Je("common.chooseText"):""}const fo=le({name:"EditableCell",components:{FormOutlined:tt,CloseOutlined:Yt,CheckOutlined:Xt,CellComponent:uo,ASpin:Jt},directives:{clickOutside:In},props:{value:{type:[String,Number,Boolean,Object],default:""},record:{type:Object},column:{type:Object,default:()=>({})},index:j.number},setup(e){const n=_e(),o=H(!1),r=H(),s=H(!1),u=H(""),i=H([]),d=H(e.value),l=H(e.value),a=H(!1),{prefixCls:y}=Te("editable-cell"),v=F(()=>{var c;return((c=e.column)==null?void 0:c.editComponent)||"Input"}),m=F(()=>{var c;return(c=e.column)==null?void 0:c.editRule}),S=F(()=>t(u)&&t(s)),b=F(()=>{const c=t(v);return["Checkbox","Switch"].includes(c)}),w=F(()=>{var Y,X;const c=(X=(Y=e.column)==null?void 0:Y.editComponentProps)!=null?X:{},f=t(v),p={};f==="ApiSelect"&&(p.cache=!0);const T=t(b),k=T?"checked":"value",x=t(d),q=T?Ye(x)&&Q(x)?x:!!x:x;return ie(I(I({size:"small",getPopupContainer:()=>{var ee;return(ee=t(n==null?void 0:n.wrapRef.value))!=null?ee:document.body},getCalendarContainer:()=>{var ee;return(ee=t(n==null?void 0:n.wrapRef.value))!=null?ee:document.body},placeholder:bt(t(v))},p),Ee(c,"onChange")),{[k]:q})}),C=F(()=>{var q,Y;const{editComponentProps:c,editValueMap:f}=e.column,p=t(d);if(f&&z(f))return f(p);if(!t(v).includes("Select"))return p;const x=((q=c==null?void 0:c.options)!=null?q:t(i)||[]).find(X=>`${X.value}`==`${p}`);return(Y=x==null?void 0:x.label)!=null?Y:p}),$=F(()=>t(b)||t(K)?{}:{width:"calc(100% - 48px)"}),O=F(()=>{const{align:c="center"}=e.column;return`edit-cell-align-${c}`}),K=F(()=>{const{editable:c}=e.record||{};return!!c});we(()=>{l.value=e.value,d.value=e.value}),we(()=>{const{editable:c}=e.column;(Q(c)||Q(t(K)))&&(o.value=!!c||t(K))});function V(){var c;t(K)||t((c=e.column)==null?void 0:c.editRow)||(u.value="",o.value=!0,Ce(()=>{var p;const f=t(r);(p=f==null?void 0:f.focus)==null||p.call(f)}))}async function M(c){var T,k,x;const f=t(v);c?(c==null?void 0:c.target)&&Reflect.has(c.target,"value")?d.value=c.target.value:f==="Checkbox"?d.value=c.target.checked:(Ae(c)||Q(c)||Ye(c))&&(d.value=c):d.value=c;const p=(k=(T=e.column)==null?void 0:T.editComponentProps)==null?void 0:k.onChange;p&&z(p)&&p(...arguments),(x=n.emit)==null||x.call(n,"edit-change",{column:e.column,value:t(d),record:oe(e.record)}),L()}async function L(){const{column:c,record:f}=e,{editRule:p}=c,T=t(d);if(p){if(Q(p)&&!T&&!Ye(T)){s.value=!0;const k=t(v);return u.value=bt(k),!1}if(z(p)){const k=await p(T,f);return k?(u.value=k,s.value=!0,!1):(u.value="",!0)}}return u.value="",!0}async function Z(c=!0,f=!0){var ee;if(f&&!await L())return!1;const{column:p,index:T,record:k}=e;if(!k)return!1;const{key:x,dataIndex:q}=p,Y=t(d);if(!x&&!q)return;const X=q||x;if(!k.editable){const{getBindValues:Re}=n,{beforeEditSubmit:ye,columns:he}=t(Re);if(ye&&z(ye)){a.value=!0;const Se=he.map(be=>be.dataIndex).filter(be=>!!be);let pe=!0;try{pe=await ye({record:Qt(k,Se),index:T,key:x,value:Y})}catch{pe=!1}finally{a.value=!1}if(pe===!1)return}}Zt(k,X,Y),c&&((ee=n.emit)==null||ee.call(n,"edit-end",{record:k,index:T,key:x,value:Y})),o.value=!1}async function G(){var c;((c=e.column)==null?void 0:c.editRow)||Z()}function W(){Z()}function g(){var x;o.value=!1,d.value=l.value;const{column:c,index:f,record:p}=e,{key:T,dataIndex:k}=c;(x=n.emit)==null||x.call(n,"edit-cancel",{record:p,index:f,key:k||T,value:t(d)})}function R(){var f;if(((f=e.column)==null?void 0:f.editable)||t(K))return;t(v).includes("Input")&&g()}function h(c){var T,k;const{replaceFields:f}=(k=(T=e.column)==null?void 0:T.editComponentProps)!=null?k:{};if(t(v)==="ApiTreeSelect"){const{title:x="title",value:q="value",children:Y="children"}=f||{};let X=$n(c,{children:Y});X=X.map(ee=>({label:ee[x],value:ee[q]})),i.value=X}else i.value=c}function _(c,f){var p;e.record&&(xe(e.record[c])?(p=e.record[c])==null||p.push(f):e.record[c]=[f])}return e.record&&(_("submitCbs",Z),_("validCbs",L),_("cancelCbs",g),e.column.dataIndex&&(e.record.editValueRefs||(e.record.editValueRefs={}),e.record.editValueRefs[e.column.dataIndex]=d),e.record.onCancelEdit=()=>{var c,f;xe((c=e.record)==null?void 0:c.cancelCbs)&&((f=e.record)==null||f.cancelCbs.forEach(p=>p()))},e.record.onSubmitEdit=async()=>{var c,f,p,T,k;if(xe((c=e.record)==null?void 0:c.submitCbs))return((p=(f=e.record)==null?void 0:f.onValid)==null?void 0:p.call(f))?((((T=e.record)==null?void 0:T.submitCbs)||[]).forEach(q=>q(!1,!1)),(k=n.emit)==null||k.call(n,"edit-row-end"),!0):void 0}),{isEdit:o,prefixCls:y,handleEdit:V,currentValueRef:d,handleSubmit:Z,handleChange:M,handleCancel:g,elRef:r,getComponent:v,getRule:m,onClickOutside:R,ruleMessage:u,getRuleVisible:S,getComponentProps:w,handleOptionsChange:h,getWrapperStyle:$,getWrapperClass:O,getRowEditable:K,getValues:C,handleEnter:G,handleSubmitClick:W,spinning:a}}}),go=["title"];function mo(e,n,o,r,s,u){var m;const i=D("FormOutlined"),d=D("CellComponent"),l=D("CheckOutlined"),a=D("CloseOutlined"),y=D("a-spin"),v=en("click-outside");return A(),J("div",{class:ne(e.prefixCls)},[Be(re("div",{class:ne({[`${e.prefixCls}__normal`]:!0,"ellipsis-cell":e.column.ellipsis}),onClick:n[0]||(n[0]=(...S)=>e.handleEdit&&e.handleEdit(...S))},[re("div",{class:"cell-content",title:e.column.ellipsis&&(m=e.getValues)!=null?m:""},B(e.getValues?e.getValues:"\xA0"),9,go),e.column.editRow?U("",!0):(A(),N(i,{key:0,class:ne(`${e.prefixCls}__normal-icon`)},null,8,["class"]))],2),[[Ge,!e.isEdit]]),e.isEdit?(A(),N(y,{key:0,spinning:e.spinning},{default:E(()=>[Be((A(),J("div",{class:ne(`${e.prefixCls}__wrapper`)},[P(d,qe(e.getComponentProps,{component:e.getComponent,style:e.getWrapperStyle,popoverVisible:e.getRuleVisible,rule:e.getRule,ruleMessage:e.ruleMessage,class:e.getWrapperClass,ref:"elRef",onChange:e.handleChange,onOptionsChange:e.handleOptionsChange,onPressEnter:e.handleEnter}),null,16,["component","style","popoverVisible","rule","ruleMessage","class","onChange","onOptionsChange","onPressEnter"]),e.getRowEditable?U("",!0):(A(),J("div",{key:0,class:ne(`${e.prefixCls}__action`)},[P(l,{class:ne([`${e.prefixCls}__icon`,"mx-2"]),onClick:e.handleSubmitClick},null,8,["class","onClick"]),P(a,{class:ne(`${e.prefixCls}__icon `),onClick:e.handleCancel},null,8,["class","onClick"])],2))],2)),[[v,e.onClickOutside]])]),_:1},8,["spinning"])):U("",!0)],2)}var ho=ce(fo,[["render",mo]]);function po(e){return({text:n,record:o,index:r})=>(o.onValid=async()=>{if(xe(o==null?void 0:o.validCbs)){const s=((o==null?void 0:o.validCbs)||[]).map(i=>i());return(await Promise.all(s)).every(i=>!!i)}else return!1},o.onEdit=async(s,u=!1)=>{var i,d;return u||(o.editable=s),!s&&u?await o.onValid()&&await((i=o.onSubmitEdit)==null?void 0:i.call(o))?(o.editable=!1,!0):!1:(!s&&!u&&((d=o.onCancelEdit)==null||d.call(o)),!0)},Pe(ho,{value:n,record:o,column:e,index:r}))}function Ct(e,n){const{key:o,dataIndex:r,children:s}=e;e.align=e.align||Bn,n&&(o||(e.key=r),Q(e.ellipsis)||Object.assign(e,{ellipsis:n})),s&&s.length&&yt(s,!!n)}function yt(e,n){!e||e.forEach(o=>{const{children:r}=o;Ct(o,n),yt(r,n)})}function bo(e,n,o){const{t:r}=me(),{showIndexColumn:s,indexColumnProps:u,isTreeTable:i}=t(e);let d=!1;if(t(i)||(o.forEach(()=>{const a=o.findIndex(y=>y.flag===Le);s?d=a===-1:!s&&a!==-1&&o.splice(a,1)}),!d))return;const l=o.some(a=>a.fixed==="left");o.unshift(I(I({flag:Le,width:50,title:r("component.table.index"),align:"center",customRender:({index:a})=>{const y=t(n);if(Q(y))return`${a+1}`;const{current:v=1,pageSize:m=Ve}=y;return((v<1?1:v)-1)*m+a+1}},l?{fixed:"left"}:{}),u))}function Co(e,n){const{actionColumn:o}=t(e);if(!o)return;const r=n.findIndex(s=>s.flag===ze);r===-1&&n.push(ie(I(ie(I({},n[r]),{fixed:"right"}),o),{flag:ze}))}function yo(e,n){const o=H(t(e).columns);let r=t(e).columns;const s=F(()=>{const m=Fe(t(o));if(bo(e,n,m),Co(e,m),!m)return[];const{ellipsis:S}=t(e);return m.forEach(b=>{const{customRender:w,slots:C}=b;Ct(b,Reflect.has(b,"ellipsis")?!!b.ellipsis:!!S&&!w&&!C)}),m});function u(m){const S=m.ifShow;let b=!0;return Q(S)&&(b=S),z(S)&&(b=S(m)),b}const{hasPermission:i}=Fn(),d=F(()=>{const m=St(t(s));return Fe(m).filter(b=>i(b.auth)&&u(b)).map(b=>{const{slots:w,dataIndex:C,customRender:$,format:O,edit:K,editRow:V,flag:M}=b;(!w||!(w==null?void 0:w.title))&&(b.slots=I({title:`header-${C}`},w||{}),b.customTitle=b.title,Reflect.deleteProperty(b,"title"));const L=[Le,ze].includes(M);return!$&&O&&!K&&!L&&(b.customRender=({text:Z,record:G,index:W})=>So(Z,O,G,W)),(K||V)&&!L&&(b.customRender=po(b)),b})});ge(()=>t(e).columns,m=>{var S;o.value=m,r=(S=m==null?void 0:m.filter(b=>!b.flag))!=null?S:[]});function l(m,S){!m||!S||r.forEach(b=>{if(b.dataIndex===m){Object.assign(b,S);return}})}function a(m){const S=Fe(m);if(!xe(S))return;if(S.length<=0){o.value=[];return}const b=S[0],w=r.map(C=>C.dataIndex);if(!Ae(b))o.value=S;else{const C=S,$=[];r.forEach(O=>{C.includes(O.dataIndex||O.key)?$.push(ie(I({},O),{defaultHidden:!1})):$.push(ie(I({},O),{defaultHidden:!0}))}),tn(w,S)||$.sort((O,K)=>w.indexOf(O.dataIndex)-w.indexOf(K.dataIndex)),o.value=$}}function y(m){const{ignoreIndex:S,ignoreAction:b,sort:w}=m||{};let C=oe(t(s));return S&&(C=C.filter($=>$.flag!==Le)),b&&(C=C.filter($=>$.flag!==ze)),w&&(C=St(C)),C}function v(){return r}return{getColumnsRef:s,getCacheColumns:v,getColumns:y,setColumns:a,getViewColumns:d,setCacheColumnsByField:l}}function St(e){const n=[],o=[],r=[];for(const s of e){if(s.fixed==="left"){n.push(s);continue}if(s.fixed==="right"){o.push(s);continue}r.push(s)}return[...n,...r,...o].filter(s=>!s.defaultHidden)}function So(e,n,o,r){if(!n)return e;if(z(n))return n(e,o,r);try{const s="date|";if(Ae(n)&&n.startsWith(s)){const u=n.replace(s,"");return u?Dn(e,u):e}if(Pn(n))return n.get(e)}catch{return e}}function vo(e,{getPaginationInfo:n,setPagination:o,setLoading:r,getFieldsValue:s,clearSelectedRowKeys:u,tableData:i},d){const l=ot({sortInfo:{},filterInfo:{}}),a=H([]),y=H({});we(()=>{i.value=t(a)}),ge(()=>t(e).dataSource,()=>{const{dataSource:g,api:R}=t(e);!R&&g&&(a.value=g)},{immediate:!0});function v(g,R,h){const{clearSelectOnPageChange:_,sortFn:c,filterFn:f}=t(e);_&&u(),o(g);const p={};if(h&&z(c)){const T=c(h);l.sortInfo=T,p.sortInfo=T}if(R&&z(f)){const T=f(R);l.filterInfo=T,p.filterInfo=T}M(p)}function m(g){!g||!Array.isArray(g)||g.forEach(R=>{R[ue]||(R[ue]=pt()),R.children&&R.children.length&&m(R.children)})}const S=F(()=>t(e).autoCreateKey&&!t(e).rowKey),b=F(()=>{const{rowKey:g}=t(e);return t(S)?ue:g}),w=F(()=>{const g=t(a);if(!g||g.length===0)return t(a);if(t(S)){const R=g[0],h=g[g.length-1];if(R&&h&&(!R[ue]||!h[ue])){const _=Fe(t(a));_.forEach(c=>{c[ue]||(c[ue]=pt()),c.children&&c.children.length&&m(c.children)}),a.value=_}}return t(a)});async function C(g,R,h){return a.value[g]&&(a.value[g][R]=h),a.value[g]}function $(g,R){const h=V(g);if(h){for(const _ in h)Reflect.has(R,_)&&(h[_]=R[_]);return h}}function O(g){var _,c,f;if(!a.value||a.value.length==0)return;const R=t(b);if(!R)return;const h=Array.isArray(g)?g:[g];for(const p of h){let T=a.value.findIndex(k=>{let x;return typeof R=="function"?x=R(k):x=R,k[x]===p});T>=0&&a.value.splice(T,1),T=(_=t(e).dataSource)==null?void 0:_.findIndex(k=>{let x;return typeof R=="function"?x=R(k):x=R,k[x]===p}),typeof T!="undefined"&&T!==-1&&((c=t(e).dataSource)==null||c.splice(T,1))}o({total:(f=t(e).dataSource)==null?void 0:f.length})}function K(g,R){var h,_;if(!(!a.value||a.value.length==0))return R=R!=null?R:(h=a.value)==null?void 0:h.length,t(a).splice(R,0,g),(_=t(e).dataSource)==null||_.splice(R,0,g),t(e).dataSource}function V(g){if(!a.value||a.value.length==0)return;const R=t(b);if(!R)return;const{childrenColumnName:h="children"}=t(e);return(c=>{let f;return c.some(function p(T){if(typeof R=="function"){if(R(T)===g)return f=T,!0}else if(Reflect.has(T,R)&&T[R]===g)return f=T,!0;return T[h]&&T[h].some(p)}),f})(a.value)}async function M(g){var x,q,Y;const{api:R,searchInfo:h,defSort:_,fetchSetting:c,beforeFetch:f,afterFetch:p,useSearchForm:T,pagination:k}=t(e);if(!(!R||!z(R)))try{r(!0);const{pageField:X,sizeField:ee,listField:Re,totalField:ye}=Object.assign({},ht,c);let he={};const{current:Se=1,pageSize:pe=Ve}=t(n);Q(k)&&!k||Q(n)?he={}:(he[X]=g&&g.page||Se,he[ee]=pe);const{sortInfo:be={},filterInfo:We}=l;let ke=I(I(I(I(I(I(I(I(I({},he),T?s():{}),h),(x=g==null?void 0:g.searchInfo)!=null?x:{}),_),be),We),(q=g==null?void 0:g.sortInfo)!=null?q:{}),(Y=g==null?void 0:g.filterInfo)!=null?Y:{});f&&z(f)&&(ke=await f(ke)||ke);const ve=await R(ke);y.value=ve;const De=Array.isArray(ve);let fe=De?ve:at(ve,Re);const Ie=De?0:at(ve,ye);if(Ie){const He=Math.ceil(Ie/pe);if(Se>He)return o({current:He}),await M(g)}return p&&z(p)&&(fe=await p(fe)||fe),a.value=fe,o({total:Ie||0}),g&&g.page&&o({current:g.page||1}),d("fetch-success",{items:t(fe),total:Ie}),fe}catch(X){d("fetch-error",X),a.value=[],o({total:0})}finally{r(!1)}}function L(g){a.value=g}function Z(){return w.value}function G(){return y.value}async function W(g){return await M(g)}return nn(()=>{Gn(()=>{t(e).immediate&&M()},16)}),{getDataSourceRef:w,getDataSource:Z,getRawDataSource:G,getRowKey:b,setTableData:L,getAutoCreateKey:S,fetch:M,reload:W,updateTableData:C,updateTableDataRecord:$,deleteTableDataRecord:O,insertTableDataRecord:K,findTableDataRecord:V,handleTableChange:v}}function wo(e){const n=H(t(e).loading);ge(()=>t(e).loading,s=>{n.value=s});const o=F(()=>t(n));function r(s){n.value=s}return{getLoading:o,setLoading:r}}function To(e,n,o){const r=H([]),s=H([]),u=F(()=>{const{rowSelection:w}=t(e);return w?I({selectedRowKeys:t(r),hideDefaultSelections:!1,onChange:C=>{l(C)}},Ee(w,["onChange"])):null});ge(()=>{var w;return(w=t(e).rowSelection)==null?void 0:w.selectedRowKeys},w=>{l(w)}),ge(()=>t(r),()=>{Ce(()=>{const{rowSelection:w}=t(e);if(w){const{onChange:C}=w;C&&z(C)&&C(m(),S())}o("selection-change",{keys:m(),rows:S()})})},{deep:!0});const i=F(()=>t(e).autoCreateKey&&!t(e).rowKey),d=F(()=>{const{rowKey:w}=t(e);return t(i)?ue:w});function l(w){var O;r.value=w;const C=En(oe(t(n)).concat(oe(t(s))),K=>w.includes(K[t(d)]),{children:(O=e.value.childrenColumnName)!=null?O:"children"}),$=[];w.forEach(K=>{const V=C.find(M=>M[t(d)]===K);V&&$.push(V)}),s.value=$}function a(w){s.value=w}function y(){s.value=[],r.value=[]}function v(w){const $=t(r).findIndex(O=>O===w);$!==-1&&t(r).splice($,1)}function m(){return t(r)}function S(){return t(s)}function b(){return t(u)}return{getRowSelection:b,getRowSelectionRef:u,getSelectRows:S,getSelectRowKeys:m,setSelectedRowKeys:l,clearSelectedRowKeys:y,deleteSelectRowByKey:v,setSelectedRows:a}}function _o(e,n,o,r,s){const u=H(null),i=Yn(),d=on(a,100),l=F(()=>{const{canResize:$,scroll:O}=t(e);return $&&!(O||{}).y});ge(()=>{var $;return[t(l),($=t(s))==null?void 0:$.length]},()=>{d()},{flush:"post"});function a(){Ce(()=>{b()})}function y($){var O;u.value=$,(O=i==null?void 0:i.redoModalHeight)==null||O.call(i)}let v,m,S;async function b(){var p;const{resizeHeightOffset:$,pagination:O,maxHeight:K}=t(e),V=t(s),M=t(n);if(!M)return;const L=M.$el;if(!L||!S&&(S=L.querySelector(".ant-table-body"),!S))return;const Z=S.scrollHeight>S.clientHeight,G=S.scrollWidth>S.clientWidth;if(Z?L.classList.contains("hide-scrollbar-y")&&L.classList.remove("hide-scrollbar-y"):!L.classList.contains("hide-scrollbar-y")&&L.classList.add("hide-scrollbar-y"),G?L.classList.contains("hide-scrollbar-x")&&L.classList.remove("hide-scrollbar-x"):!L.classList.contains("hide-scrollbar-x")&&L.classList.add("hide-scrollbar-x"),S.style.height="unset",!t(l)||V.length===0)return;await Ce();const W=L.querySelector(".ant-table-thead ");if(!W)return;const{bottomIncludeBody:g}=On(W),R=32;let h=2;Q(O)?h=-8:(v=L.querySelector(".ant-pagination"),v?h+=v.offsetHeight||0:h+=24);let _=0;Q(O)||(m?_+=m.offsetHeight||0:m=L.querySelector(".ant-table-footer"));let c=0;W&&(c=W.offsetHeight);let f=g-($||0)-R-h-_-c;f=(p=f>K?K:f)!=null?p:f,y(f),S.style.height=`${f}px`}qn(b,280),Jn(()=>{b(),Ce(()=>{d()})});const w=F(()=>{var G,W;let $=0;t(r)&&($+=60);const O=150,K=t(o).filter(g=>!g.defaultHidden);K.forEach(g=>{$+=Number.parseInt(g.width)||0});const M=K.filter(g=>!Reflect.has(g,"width")).length;M!==0&&($+=M*O);const L=t(n);return((W=(G=L==null?void 0:L.$el)==null?void 0:G.offsetWidth)!=null?W:0)>$?"100%":$});return{getScrollRef:F(()=>{const $=t(u),{canResize:O,scroll:K}=t(e);return I({x:t(w),y:O?$:null,scrollToFirstRowOnChange:!1},K)}),redoHeight:a}}function Ro(e,n,o){return!n||o?e[ue]:Ae(n)?e[n]:z(n)?e[n(e)]:null}function ko(e,{setSelectedRowKeys:n,getSelectRowKeys:o,getAutoCreateKey:r,clearSelectedRowKeys:s,emit:u}){return{customRow:(d,l)=>({onClick:a=>{a==null||a.stopPropagation();function y(){var O;const{rowSelection:v,rowKey:m,clickToRowSelect:S}=t(e);if(!v||!S)return;const b=o(),w=Ro(d,m,t(r));if(!w)return;if(v.type==="checkbox"){const K=(O=a.composedPath)==null?void 0:O.call(a).find(L=>L.tagName==="TR");if(!K)return;const V=K.querySelector("input[type=checkbox]");if(!V||V.hasAttribute("disabled"))return;if(!b.includes(w)){n([...b,w]);return}const M=b.findIndex(L=>L===w);b.splice(M,1),n(b);return}if(v.type==="radio"){if(!b.includes(w)){b.length&&s(),n([w]);return}s()}}y(),u("row-click",d,l,a)},onDblclick:a=>{u("row-dbClick",d,l,a)},onContextmenu:a=>{u("row-contextmenu",d,l,a)},onMouseenter:a=>{u("row-mouseenter",d,l,a)},onMouseleave:a=>{u("row-mouseleave",d,l,a)}})}}function Io(e,n){function o(r,s){const{striped:u,rowClassName:i}=t(e),d=[];return u&&d.push((s||0)%2==1?`${n}-row__striped`:""),i&&z(i)&&d.push(i(r,s)),d.filter(l=>!!l).join(" ")}return{getRowClassName:o}}const $o=le({name:"ColumnSetting",components:{SettingOutlined:an,Popover:nt,Tooltip:Ne,Checkbox:Ue,CheckboxGroup:Ue.Group,DragOutlined:ln,ScrollContainer:Rn,Divider:lt,Icon:xn},emits:["columns-change"],setup(e,{emit:n,attrs:o}){const{t:r}=me(),s=_e(),u=Ee(s.getRowSelection(),"selectedRowKeys");let i=!1;const d=H([]),l=H([]),a=H([]),y=H(null),v=ot({checkAll:!0,checkedList:[],defaultCheckList:[]}),m=H(!1),S=H(!1),{prefixCls:b}=Te("basic-column-setting"),w=F(()=>t(s==null?void 0:s.getBindValues)||{});we(()=>{s.getColumns().length&&$()}),we(()=>{const h=t(w);m.value=!!h.showIndexColumn,S.value=!!h.rowSelection});function C(){const h=[];return s.getColumns({ignoreIndex:!0,ignoreAction:!0}).forEach(_=>{h.push(I({label:_.title||_.customTitle,value:_.dataIndex||_.title},_))}),h}function $(){const h=C(),_=s.getColumns({ignoreAction:!0}).map(c=>c.defaultHidden?"":c.dataIndex||c.title).filter(Boolean);l.value.length?t(l).forEach(c=>{const f=h.find(p=>p.dataIndex===c.dataIndex);f&&(c.fixed=f.fixed)}):(l.value=h,a.value=h,d.value=h,v.defaultCheckList=_),v.checkedList=_}function O(h){const _=l.value.map(c=>c.value);h.target.checked?(v.checkedList=_,g(_)):(v.checkedList=[],g([]))}const K=F(()=>{const h=l.value.length;let _=v.checkedList.length;return t(m)&&_--,_>0&&_<h});function V(h){const _=l.value.length;v.checkAll=h.length===_;const c=t(a).map(f=>f.value);h.sort((f,p)=>c.indexOf(f)-c.indexOf(p)),g(h)}function M(){v.checkedList=[...v.defaultCheckList],v.checkAll=!0,l.value=t(d),a.value=t(d),g(s.getCacheColumns())}function L(){i||Ce(()=>{const h=t(y);if(!h)return;const _=h.$el;if(!_)return;const{initSortable:c}=Qn(_,{handle:".table-coulmn-drag-icon ",onEnd:f=>{const{oldIndex:p,newIndex:T}=f;if(gt(p)||gt(T)||p===T)return;const k=C();p>T?(k.splice(T,0,k[p]),k.splice(p+1,1)):(k.splice(T+1,0,k[p]),k.splice(p,1)),a.value=k,l.value=k,g(k)}});c(),i=!0})}function Z(h){s.setProps({showIndexColumn:h.target.checked})}function G(h){s.setProps({rowSelection:h.target.checked?u:void 0})}function W(h,_){var T;if(!v.checkedList.includes(h.dataIndex))return;const c=C(),f=h.fixed===_?!1:_,p=c.findIndex(k=>k.dataIndex===h.dataIndex);p!==-1&&(c[p].fixed=f),h.fixed=f,f&&!h.width&&(h.width=100),(T=s.setCacheColumnsByField)==null||T.call(s,h.dataIndex,{fixed:f}),g(c)}function g(h){s.setColumns(h);const _=t(l).map(c=>{const f=h.findIndex(p=>p===c.value||typeof p!="string"&&p.dataIndex===c.value)!==-1;return{dataIndex:c.value,fixed:c.fixed,visible:f}});n("columns-change",_)}function R(){return z(o.getPopupContainer)?o.getPopupContainer():ft()}return ie(I({t:r},sn(v)),{indeterminate:K,onCheckAllChange:O,onChange:V,plainOptions:l,reset:M,prefixCls:b,columnListRef:y,handleVisibleChange:L,checkIndex:m,checkSelect:S,handleIndexCheckChange:Z,handleSelectCheckChange:G,defaultRowSelection:u,handleColumnFixed:W,getPopupContainer:R})}});function Fo(e,n,o,r,s,u){const i=D("Checkbox"),d=D("a-button"),l=D("DragOutlined"),a=D("Icon"),y=D("Tooltip"),v=D("Divider"),m=D("CheckboxGroup"),S=D("ScrollContainer"),b=D("SettingOutlined"),w=D("Popover");return A(),N(y,{placement:"top"},{title:E(()=>[re("span",null,B(e.t("component.table.settingColumn")),1)]),default:E(()=>[P(w,{placement:"bottomLeft",trigger:"click",onVisibleChange:e.handleVisibleChange,overlayClassName:`${e.prefixCls}__cloumn-list`,getPopupContainer:e.getPopupContainer},{title:E(()=>[re("div",{class:ne(`${e.prefixCls}__popover-title`)},[P(i,{indeterminate:e.indeterminate,checked:e.checkAll,"onUpdate:checked":n[0]||(n[0]=C=>e.checkAll=C),onChange:e.onCheckAllChange},{default:E(()=>[se(B(e.t("component.table.settingColumnShow")),1)]),_:1},8,["indeterminate","checked","onChange"]),P(i,{checked:e.checkIndex,"onUpdate:checked":n[1]||(n[1]=C=>e.checkIndex=C),onChange:e.handleIndexCheckChange},{default:E(()=>[se(B(e.t("component.table.settingIndexColumnShow")),1)]),_:1},8,["checked","onChange"]),P(i,{checked:e.checkSelect,"onUpdate:checked":n[2]||(n[2]=C=>e.checkSelect=C),onChange:e.handleSelectCheckChange,disabled:!e.defaultRowSelection},{default:E(()=>[se(B(e.t("component.table.settingSelectColumnShow")),1)]),_:1},8,["checked","onChange","disabled"]),P(d,{size:"small",type:"link",onClick:e.reset},{default:E(()=>[se(B(e.t("common.resetText")),1)]),_:1},8,["onClick"])],2)]),content:E(()=>[P(S,null,{default:E(()=>[P(m,{value:e.checkedList,"onUpdate:value":n[3]||(n[3]=C=>e.checkedList=C),onChange:e.onChange,ref:"columnListRef"},{default:E(()=>[(A(!0),J(Me,null,Oe(e.plainOptions,C=>(A(),J(Me,{key:C.value},["ifShow"in C&&!C.ifShow?U("",!0):(A(),J("div",{key:0,class:ne(`${e.prefixCls}__check-item`)},[P(l,{class:"table-coulmn-drag-icon"}),P(i,{value:C.value},{default:E(()=>[se(B(C.label),1)]),_:2},1032,["value"]),P(y,{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:e.getPopupContainer},{title:E(()=>[se(B(e.t("component.table.settingFixedLeft")),1)]),default:E(()=>[P(a,{icon:"line-md:arrow-align-left",class:ne([`${e.prefixCls}__fixed-left`,{active:C.fixed==="left",disabled:!e.checkedList.includes(C.value)}]),onClick:$=>e.handleColumnFixed(C,"left")},null,8,["class","onClick"])]),_:2},1032,["mouseLeaveDelay","getPopupContainer"]),P(v,{type:"vertical"}),P(y,{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:e.getPopupContainer},{title:E(()=>[se(B(e.t("component.table.settingFixedRight")),1)]),default:E(()=>[P(a,{icon:"line-md:arrow-align-left",class:ne([`${e.prefixCls}__fixed-right`,{active:C.fixed==="right",disabled:!e.checkedList.includes(C.value)}]),onClick:$=>e.handleColumnFixed(C,"right")},null,8,["class","onClick"])]),_:2},1032,["mouseLeaveDelay","getPopupContainer"])],2))],64))),128))]),_:1},8,["value","onChange"])]),_:1})]),default:E(()=>[P(b)]),_:1},8,["onVisibleChange","overlayClassName","getPopupContainer"])]),_:1})}var Do=ce($o,[["render",Fo]]);const Po=le({name:"SizeSetting",components:{ColumnHeightOutlined:rn,Tooltip:Ne,Dropdown:cn,Menu:st,MenuItem:st.Item},setup(){const e=_e(),{t:n}=me(),o=H([e.getSize()]);function r({key:s}){o.value=[s],e.setProps({size:s})}return{handleTitleClick:r,selectedKeysRef:o,getPopupContainer:ft,t:n}}});function Eo(e,n,o,r,s,u){const i=D("ColumnHeightOutlined"),d=D("MenuItem"),l=D("Menu"),a=D("Dropdown"),y=D("Tooltip");return A(),N(y,{placement:"top"},{title:E(()=>[re("span",null,B(e.t("component.table.settingDens")),1)]),default:E(()=>[P(a,{placement:"bottomCenter",trigger:["click"],getPopupContainer:e.getPopupContainer},{overlay:E(()=>[P(l,{onClick:e.handleTitleClick,selectable:"",selectedKeys:e.selectedKeysRef,"onUpdate:selectedKeys":n[0]||(n[0]=v=>e.selectedKeysRef=v)},{default:E(()=>[P(d,{key:"default"},{default:E(()=>[re("span",null,B(e.t("component.table.settingDensDefault")),1)]),_:1}),P(d,{key:"middle"},{default:E(()=>[re("span",null,B(e.t("component.table.settingDensMiddle")),1)]),_:1}),P(d,{key:"small"},{default:E(()=>[re("span",null,B(e.t("component.table.settingDensSmall")),1)]),_:1})]),_:1},8,["onClick","selectedKeys"])]),default:E(()=>[P(i)]),_:1},8,["getPopupContainer"])]),_:1})}var Oo=ce(Po,[["render",Eo]]);const xo=le({name:"RedoSetting",components:{RedoOutlined:un,Tooltip:Ne},setup(){const e=_e(),{t:n}=me();function o(){e.reload()}return{redo:o,t:n}}});function Ao(e,n,o,r,s,u){const i=D("RedoOutlined"),d=D("Tooltip");return A(),N(d,{placement:"top"},{title:E(()=>[re("span",null,B(e.t("common.redo")),1)]),default:E(()=>[P(i,{onClick:e.redo},null,8,["onClick"])]),_:1})}var Lo=ce(xo,[["render",Ao]]);const Ho=le({name:"FullScreenSetting",components:{FullscreenExitOutlined:dn,FullscreenOutlined:fn,Tooltip:Ne},setup(){const e=_e(),{t:n}=me(),{toggle:o,isFullscreen:r}=gn(e.wrapRef);return{toggle:o,isFullscreen:r,t:n}}});function Ko(e,n,o,r,s,u){const i=D("FullscreenOutlined"),d=D("FullscreenExitOutlined"),l=D("Tooltip");return A(),N(l,{placement:"top"},{title:E(()=>[re("span",null,B(e.t("component.table.settingFullScreen")),1)]),default:E(()=>[e.isFullscreen?(A(),N(d,{key:1,onClick:e.toggle},null,8,["onClick"])):(A(),N(i,{key:0,onClick:e.toggle},null,8,["onClick"]))]),_:1})}var jo=ce(Ho,[["render",Ko]]);const Mo=le({name:"TableSetting",components:{ColumnSetting:Do,SizeSetting:Oo,RedoSetting:Lo,FullScreenSetting:jo},props:{setting:{type:Object,default:()=>({})}},emits:["columns-change"],setup(e,{emit:n}){const{t:o}=me(),r=_e(),s=F(()=>I({redo:!0,size:!0,setting:!0,fullScreen:!1},e.setting));function u(d){n("columns-change",d)}function i(){return r?t(r.wrapRef):document.body}return{getSetting:s,t:o,handleColumnChange:u,getTableContainer:i}}}),Bo={class:"table-settings"};function No(e,n,o,r,s,u){const i=D("RedoSetting"),d=D("SizeSetting"),l=D("ColumnSetting"),a=D("FullScreenSetting");return A(),J("div",Bo,[e.getSetting.redo?(A(),N(i,{key:0,getPopupContainer:e.getTableContainer},null,8,["getPopupContainer"])):U("",!0),e.getSetting.size?(A(),N(d,{key:1,getPopupContainer:e.getTableContainer},null,8,["getPopupContainer"])):U("",!0),e.getSetting.setting?(A(),N(l,{key:2,onColumnsChange:e.handleColumnChange,getPopupContainer:e.getTableContainer},null,8,["onColumnsChange","getPopupContainer"])):U("",!0),e.getSetting.fullScreen?(A(),N(a,{key:3,getPopupContainer:e.getTableContainer},null,8,["getPopupContainer"])):U("",!0)])}var Vo=ce(Mo,[["render",No]]);const zo=le({name:"BasicTableTitle",components:{BasicTitle:kn},props:{title:{type:[Function,String]},getSelectRows:{type:Function},helpMessage:{type:[String,Array]}},setup(e){const{prefixCls:n}=Te("basic-table-title");return{getTitle:F(()=>{const{title:r,getSelectRows:s=()=>{}}=e;let u=r;return z(r)&&(u=r({selectRows:s()})),u}),prefixCls:n}}});function Wo(e,n,o,r,s,u){const i=D("BasicTitle");return e.getTitle?(A(),N(i,{key:0,class:ne(e.prefixCls),helpMessage:e.helpMessage},{default:E(()=>[se(B(e.getTitle),1)]),_:1},8,["class","helpMessage"])):U("",!0)}var Uo=ce(zo,[["render",Wo]]);const Go=le({name:"BasicTableHeader",components:{Divider:lt,TableTitle:Uo,TableSetting:Vo},props:{title:{type:[Function,String]},tableSetting:{type:Object},showTableSetting:{type:Boolean},titleHelpMessage:{type:[String,Array],default:""}},emits:["columns-change"],setup(e,{emit:n}){const{prefixCls:o}=Te("basic-table-header");function r(s){n("columns-change",s)}return{prefixCls:o,handleColumnChange:r}}}),qo={style:{width:"100%"}},Yo={key:0,style:{margin:"5px"}},Xo={class:"flex items-center"};function Jo(e,n,o,r,s,u){const i=D("TableTitle"),d=D("Divider"),l=D("TableSetting");return A(),J("div",qo,[e.$slots.headerTop?(A(),J("div",Yo,[$e(e.$slots,"headerTop")])):U("",!0),re("div",Xo,[e.$slots.tableTitle?$e(e.$slots,"tableTitle",{key:0}):U("",!0),!e.$slots.tableTitle&&e.title?(A(),N(i,{key:1,helpMessage:e.titleHelpMessage,title:e.title},null,8,["helpMessage","title"])):U("",!0),re("div",{class:ne(`${e.prefixCls}__toolbar`)},[$e(e.$slots,"toolbar"),e.$slots.toolbar&&e.showTableSetting?(A(),N(d,{key:0,type:"vertical"})):U("",!0),e.showTableSetting?(A(),N(l,{key:1,setting:e.tableSetting,onColumnsChange:e.handleColumnChange},null,8,["setting","onColumnsChange"])):U("",!0)],2)])])}var Qo=ce(Go,[["render",Jo]]);function Zo(e,n,o){return{getHeaderProps:F(()=>{const{title:s,showTableSetting:u,titleHelpMessage:i,tableSetting:d}=t(e),l=!n.tableTitle&&!s&&!n.toolbar&&!u;return l&&!Ae(s)?{}:{title:l?null:()=>Pe(Qo,{title:s,titleHelpMessage:i,showTableSetting:u,tableSetting:d,onColumnsChange:o.onColumnsChange},I(I(I({},n.toolbar?{toolbar:()=>Xe(n,"toolbar")}:{}),n.tableTitle?{tableTitle:()=>Xe(n,"tableTitle")}:{}),n.headerTop?{headerTop:()=>Xe(n,"headerTop")}:{}))}})}}function ea(e,n,o){const r=H([]),s=F(()=>t(e).autoCreateKey&&!t(e).rowKey),u=F(()=>{const{rowKey:y}=t(e);return t(s)?ue:y}),i=F(()=>{const{isTreeTable:y}=t(e);return y?{expandedRowKeys:t(r),onExpandedRowsChange:v=>{r.value=v,o("expanded-rows-change",v)}}:{}});function d(){const y=l();r.value=y}function l(y){const v=[],{childrenColumnName:m}=t(e);return oe(y||t(n)).forEach(S=>{v.push(S[t(u)]);const b=S[m||"children"];(b==null?void 0:b.length)&&v.push(...l(b))}),v}function a(){r.value=[]}return{getExpandOption:i,expandAll:d,collapseAll:a}}const vt="_row",wt="_index",ta=le({name:"BasicTableFooter",components:{Table:it},props:{summaryFunc:{type:Function},summaryData:{type:Array},scroll:{type:Object},rowKey:j.string.def("key")},setup(e){const n=_e(),o=F(()=>{const{summaryFunc:s,summaryData:u}=e;if(u==null?void 0:u.length)return u.forEach((d,l)=>d[e.rowKey]=`${l}`),u;if(!z(s))return[];let i=oe(t(n.getDataSource()));return i=s(i),i.forEach((d,l)=>{d[e.rowKey]=`${l}`}),i});return{getColumns:F(()=>{const s=t(o),u=Fe(n.getColumns()),i=u.findIndex(a=>a.flag===Le),d=s.some(a=>Reflect.has(a,vt)),l=s.some(a=>Reflect.has(a,wt));if(i!==-1&&(l?(u[i].customRender=({record:a})=>a[wt],u[i].ellipsis=!1):Reflect.deleteProperty(u[i],"customRender")),n.getRowSelection()&&d){const a=u.some(y=>y.fixed==="left");u.unshift(ie(I({width:60,title:"selection",key:"selectionKey",align:"center"},a?{fixed:"left"}:{}),{customRender:({record:y})=>y[vt]}))}return u}),getDataSource:o}}});function na(e,n,o,r,s,u){const i=D("Table");return e.summaryFunc||e.summaryData?(A(),N(i,{key:0,showHeader:!1,bordered:!1,pagination:!1,dataSource:e.getDataSource,rowKey:d=>d[e.rowKey],columns:e.getColumns,tableLayout:"fixed",scroll:e.scroll},null,8,["dataSource","rowKey","columns","scroll"])):U("",!0)}var oa=ce(ta,[["render",na]]);function aa(e,n,o,r){const s=F(()=>(t(r)||[]).length===0),u=F(()=>{const{summaryFunc:d,showSummary:l,summaryData:a}=t(e);return l&&!t(s)?()=>Pe(oa,{summaryFunc:d,summaryData:a,scroll:t(n)}):void 0});we(()=>{i()});function i(){const{showSummary:d}=t(e);!d||t(s)||Ce(()=>{const l=t(o);if(!l)return;const y=l.$el.querySelectorAll(".ant-table-body")[0];An({el:y,name:"scroll",listener:()=>{const v=l.$el.querySelector(".ant-table-footer .ant-table-body");!v||!y||(v.scrollLeft=y.scrollLeft)},wait:0,options:!0})})}return{getFooterProps:u}}function la(e,n,o,r){const s=F(()=>{const{formConfig:l}=t(e),{submitButtonOptions:a}=l||{};return ie(I({showAdvancedButton:!0},l),{submitButtonOptions:I({loading:t(r)},a),compact:!0})}),u=F(()=>Object.keys(n).map(a=>a.startsWith("form-")?a:null).filter(a=>!!a));function i(l){var a,y;return l&&(y=(a=l==null?void 0:l.replace)==null?void 0:a.call(l,/form\-/,""))!=null?y:""}function d(l){const{handleSearchInfoFn:a}=t(e);a&&z(a)&&(l=a(l)||l),o({searchInfo:l,page:1})}return{getFormProps:s,replaceFormSlotKey:i,getFormSlotKeys:u,handleSearchInfoChange:d}}const sa={clickToRowSelect:j.bool.def(!0),isTreeTable:j.bool.def(!1),tableSetting:j.shape({}),inset:j.bool,sortFn:{type:Function,default:Nn},filterFn:{type:Function,default:Vn},showTableSetting:j.bool,autoCreateKey:j.bool.def(!0),striped:j.bool.def(!0),showSummary:j.bool,summaryFunc:{type:[Function,Array],default:null},summaryData:{type:Array,default:null},indentSize:j.number.def(24),canColDrag:j.bool.def(!0),api:{type:Function,default:null},beforeFetch:{type:Function,default:null},afterFetch:{type:Function,default:null},handleSearchInfoFn:{type:Function,default:null},fetchSetting:{type:Object,default:()=>ht},immediate:j.bool.def(!0),emptyDataIsShowTable:j.bool.def(!0),searchInfo:{type:Object,default:null},defSort:{type:Object,default:null},useSearchForm:j.bool,formConfig:{type:Object,default:null},columns:{type:[Array],default:()=>[]},showIndexColumn:j.bool.def(!0),indexColumnProps:{type:Object,default:null},actionColumn:{type:Object,default:null},ellipsis:j.bool.def(!0),canResize:j.bool.def(!0),clearSelectOnPageChange:j.bool,resizeHeightOffset:j.number.def(0),rowSelection:{type:Object,default:null},title:{type:[String,Function],default:null},titleHelpMessage:{type:[String,Array]},maxHeight:j.number,dataSource:{type:Array,default:null},rowKey:{type:[String,Function],default:""},bordered:j.bool,pagination:{type:[Object,Boolean],default:null},loading:j.bool,rowClassName:{type:Function},scroll:{type:Object,default:null},beforeEditSubmit:{type:Function},size:{type:String,default:zn}};const ia=le({components:{Table:it,BasicForm:Sn,HeaderCell:io},props:sa,emits:["fetch-success","fetch-error","selection-change","register","row-click","row-dbClick","row-contextmenu","row-mouseenter","row-mouseleave","edit-end","edit-cancel","edit-row-end","edit-change","expanded-rows-change","change","columns-change"],setup(e,{attrs:n,emit:o,slots:r,expose:s}){const u=H(null),i=H([]),d=H(null),l=H(),{prefixCls:a}=Te("basic-table"),[y,v]=vn(),m=F(()=>I(I({},e),t(l))),S=mn(wn,!1);we(()=>{t(S)&&e.canResize&&Ln("'canResize' of BasicTable may not work in PageWrapper with 'fixedHeight' (especially in hot updates)")});const{getLoading:b,setLoading:w}=wo(m),{getPaginationInfo:C,getPagination:$,setPagination:O,setShowPagination:K,getShowPagination:V}=co(m),{getRowSelection:M,getRowSelectionRef:L,getSelectRows:Z,clearSelectedRowKeys:G,getSelectRowKeys:W,deleteSelectRowByKey:g,setSelectedRowKeys:R}=To(m,i,o),{handleTableChange:h,getDataSourceRef:_,getDataSource:c,getRawDataSource:f,setTableData:p,updateTableDataRecord:T,deleteTableDataRecord:k,insertTableDataRecord:x,findTableDataRecord:q,fetch:Y,getRowKey:X,reload:ee,getAutoCreateKey:Re,updateTableData:ye}=vo(m,{tableData:i,getPaginationInfo:C,setLoading:w,setPagination:O,getFieldsValue:v.getFieldsValue,clearSelectedRowKeys:G},o);function he(...te){h.call(void 0,...te),o("change",...te);const{onChange:ae}=t(m);ae&&z(ae)&&ae.call(void 0,...te)}const{getViewColumns:Se,getColumns:pe,setCacheColumnsByField:be,setColumns:We,getColumnsRef:ke,getCacheColumns:ve}=yo(m,C),{getScrollRef:De,redoHeight:fe}=_o(m,u,ke,L,_),{customRow:Ie}=ko(m,{setSelectedRowKeys:R,getSelectRowKeys:W,clearSelectedRowKeys:G,getAutoCreateKey:Re,emit:o}),{getRowClassName:He}=Io(m,a),{getExpandOption:Tt,expandAll:_t,collapseAll:Rt}=ea(m,i,o),kt={onColumnsChange:te=>{var ae,Qe;o("columns-change",te),(Qe=(ae=t(m)).onColumnsChange)==null||Qe.call(ae,te)}},{getHeaderProps:It}=Zo(m,r,kt),{getFooterProps:$t}=aa(m,De,u,_),{getFormProps:Ft,replaceFormSlotKey:Dt,getFormSlotKeys:Pt,handleSearchInfoChange:Et}=la(m,r,Y,b),Ke=F(()=>{const te=t(_);let ae=I(ie(I(I(ie(I({},n),{customRow:Ie,expandIcon:r.expandIcon?null:eo()}),t(m)),t(It)),{scroll:t(De),loading:t(b),tableLayout:"fixed",rowSelection:t(L),rowKey:t(X),columns:oe(t(Se)),pagination:oe(t(C)),dataSource:te,footer:t($t)}),t(Tt));return r.expandedRowRender&&(ae=Ee(ae,"scroll")),ae=Ee(ae,["class","onChange"]),ae}),Ot=F(()=>{const te=t(Ke);return[a,n.class,{[`${a}-form-container`]:te.useSearchForm,[`${a}--inset`]:te.inset}]}),xt=F(()=>{const{emptyDataIsShowTable:te,useSearchForm:ae}=t(m);return te||!ae?!0:!!t(_).length});function At(te){l.value=I(I({},t(l)),te)}const je={reload:ee,getSelectRows:Z,clearSelectedRowKeys:G,getSelectRowKeys:W,deleteSelectRowByKey:g,setPagination:O,setTableData:p,updateTableDataRecord:T,deleteTableDataRecord:k,insertTableDataRecord:x,findTableDataRecord:q,redoHeight:fe,setSelectedRowKeys:R,setColumns:We,setLoading:w,getDataSource:c,getRawDataSource:f,setProps:At,getRowSelection:M,getPaginationRef:$,getColumns:pe,getCacheColumns:ve,emit:o,updateTableData:ye,setShowPagination:K,getShowPagination:V,setCacheColumnsByField:be,expandAll:_t,collapseAll:Rt,getSize:()=>t(Ke).size};return Wn(ie(I({},je),{wrapRef:d,getBindValues:Ke})),s(je),o("register",je,v),{tableElRef:u,getBindValues:Ke,getLoading:b,registerForm:y,handleSearchInfoChange:Et,getEmptyDataIsShowTable:xt,handleTableChange:he,getRowClassName:He,wrapRef:d,tableAction:je,redoHeight:fe,getFormProps:Ft,replaceFormSlotKey:Dt,getFormSlotKeys:Pt,getWrapperClass:Ot,columns:Se}}});function ra(e,n,o,r,s,u){const i=D("BasicForm"),d=D("HeaderCell"),l=D("Table");return A(),J("div",{ref:"wrapRef",class:ne(e.getWrapperClass)},[e.getBindValues.useSearchForm?(A(),N(i,qe({key:0,submitOnReset:""},e.getFormProps,{tableAction:e.tableAction,onRegister:e.registerForm,onSubmit:e.handleSearchInfoChange,onAdvancedChange:e.redoHeight}),rt({_:2},[Oe(e.getFormSlotKeys,a=>({name:e.replaceFormSlotKey(a),fn:E(y=>[$e(e.$slots,a,ct(ut(y||{})))])}))]),1040,["tableAction","onRegister","onSubmit","onAdvancedChange"])):U("",!0),Be(P(l,qe({ref:"tableElRef"},e.getBindValues,{rowClassName:e.getRowClassName,onChange:e.handleTableChange}),rt({_:2},[Oe(Object.keys(e.$slots),a=>({name:a,fn:E(y=>[$e(e.$slots,a,ct(ut(y||{})))])})),Oe(e.columns,a=>({name:`header-${a.dataIndex}`,fn:E(()=>[P(d,{column:a},null,8,["column"])])}))]),1040,["rowClassName","onChange"]),[[Ge,e.getEmptyDataIsShowTable]])],2)}var ca=ce(ia,[["render",ra]]);le({name:"TableImage",components:{Image:dt,PreviewGroup:dt.PreviewGroup,Badge:hn},props:{imgList:j.arrayOf(j.string),size:j.number.def(40),simpleShow:j.bool,showBadge:j.bool.def(!0),margin:j.number.def(4),srcPrefix:j.string.def("")},setup(e){const n=F(()=>{const{size:r}=e,s=`${r}px`;return{height:s,width:s}}),{prefixCls:o}=Te("basic-table-img");return{prefixCls:o,getWrapStyle:n}}});function ua(e){const n=H(null),o=H(!1),r=H(null);let s;function u(l,a){pn(()=>{n.value=null,o.value=null}),!(t(o)&&Hn()&&l===t(n))&&(n.value=l,r.value=a,e&&l.setProps(mt(e)),o.value=!0,s==null||s(),s=ge(()=>e,()=>{e&&l.setProps(mt(e))},{immediate:!0,deep:!0}))}function i(){const l=t(n);return l||Kn("The table instance has not been obtained yet, please make sure the table is presented when performing the table operation!"),l}return[u,{reload:async l=>await i().reload(l),setProps:l=>{i().setProps(l)},redoHeight:()=>{i().redoHeight()},setLoading:l=>{i().setLoading(l)},getDataSource:()=>i().getDataSource(),getRawDataSource:()=>i().getRawDataSource(),getColumns:({ignoreIndex:l=!1}={})=>{const a=i().getColumns({ignoreIndex:l})||[];return oe(a)},setColumns:l=>{i().setColumns(l)},setTableData:l=>i().setTableData(l),setPagination:l=>i().setPagination(l),deleteSelectRowByKey:l=>{i().deleteSelectRowByKey(l)},getSelectRowKeys:()=>oe(i().getSelectRowKeys()),getSelectRows:()=>oe(i().getSelectRows()),clearSelectedRowKeys:()=>{i().clearSelectedRowKeys()},setSelectedRowKeys:l=>{i().setSelectedRowKeys(l)},getPaginationRef:()=>i().getPaginationRef(),getSize:()=>oe(i().getSize()),updateTableData:(l,a,y)=>i().updateTableData(l,a,y),deleteTableDataRecord:l=>i().deleteTableDataRecord(l),insertTableDataRecord:(l,a)=>i().insertTableDataRecord(l,a),updateTableDataRecord:(l,a)=>i().updateTableDataRecord(l,a),findTableDataRecord:l=>i().findTableDataRecord(l),getRowSelection:()=>oe(i().getRowSelection()),getCacheColumns:()=>oe(i().getCacheColumns()),getForm:()=>t(r),setShowPagination:async l=>{i().setShowPagination(l)},getShowPagination:()=>oe(i().getShowPagination()),expandAll:()=>{i().expandAll()},collapseAll:()=>{i().collapseAll()}}]}const da={class:"p-4"},fa=["src"],Za=le({setup(e){const n=H(),o=H([]),{t:r}=me(),s=jn(),[u,{setTableData:i}]=ua({title:r("sys.errorLog.tableTitle"),columns:Zn(),actionColumn:{width:80,title:"Action",dataIndex:"action",slots:{customRender:"action"}}}),[d,{openModal:l}]=Xn();ge(()=>s.getErrorLogInfoList,S=>{Ce(()=>{i(Fe(S))})},{immediate:!0});function a(S){n.value=S,l(!0)}function y(){throw new Error("fire vue error!")}function v(){o.value.push(`${new Date().getTime()}.png`)}async function m(){}return(S,b)=>{const w=D("a-button");return A(),J("div",da,[(A(!0),J(Me,null,Oe(o.value,C=>Be((A(),J("img",{key:C,src:C},null,8,fa)),[[Ge,!1]])),128)),P(bn,{info:n.value,onRegister:t(d)},null,8,["info","onRegister"]),P(t(ca),{onRegister:t(u),class:"error-handle-table"},{toolbar:E(()=>[P(w,{onClick:y,type:"primary"},{default:E(()=>[se(B(t(r)("sys.errorLog.fireVueError")),1)]),_:1}),P(w,{onClick:v,type:"primary"},{default:E(()=>[se(B(t(r)("sys.errorLog.fireResourceError")),1)]),_:1}),P(w,{onClick:m,type:"primary"},{default:E(()=>[se(B(t(r)("sys.errorLog.fireAjaxError")),1)]),_:1})]),action:E(({record:C})=>[P(t(Un),{actions:[{label:t(r)("sys.errorLog.tableActionDesc"),onClick:a.bind(null,C)}]},null,8,["actions"])]),_:1},8,["onRegister"])])}}});export{Za as default};
